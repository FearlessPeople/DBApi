import{t as g,v as ze,n as $e,B as Le,b as Re,_ as Me}from"./index.959f545d.js";/* empty css               *//* empty css              *//* empty css              *//* empty css              *//* empty css               */import{q as qe}from"./index.4286c144.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as Oe,i as je,j as _,r as W,c as Pe,o as Je,b0 as He,c1 as Ze,D as d,E as C,aJ as e,aI as a,aN as w,aO as v,bx as V,aF as b,aL as X,aK as G,H as B,F as Ke,u as Y,aW as n,aU as Qe,b7 as We,bQ as Xe,b6 as Ge,bS as Ye,bd as eu,bT as uu,ad as au,aX as tu,bc as lu,a7 as su,bL as ou,b1 as nu,bI as ru,bJ as iu,b9 as du,bo as cu,bp as mu,bU as pu,bn as _u,bE as fu,aV as Fu,ah as vu,ag as bu,c2 as Bu,bM as gu,bF as hu,be as Du,bf as yu}from"./arco.ec9395ed.js";import{u as Cu}from"./loading.0c4c157b.js";import{a as wu}from"./sys-role-manager.c6e47909.js";import"./chart.2a47e1e9.js";import"./vue.ec003c39.js";function ku(o){return g.post("/api/user/list",qe.stringify(o),{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function Eu(o){return g.post("/api/user/create",o)}function Au(o){return g.get(`/api/user/delete?id=${o}`)}function Uu(o){return g.post("/api/user/update",o)}function Vu(o){return g.get(`/api/user/switchStatus?id=${o}`)}function xu(o){return g.get(`/api/user/roles?id=${o}`)}function Iu(o,T){const x={id:o,roleIds:T};return g.post("/api/user/update-roles",x)}const Tu=o=>(Du("data-v-40b3e171"),o=o(),yu(),o),Nu={class:"container"},Su=Tu(()=>B("div",null,"\u66F4\u65B0\u7528\u6237\u65F6\uFF0C\u8BF7\u76F4\u63A5\u8F93\u5165\u60F3\u4FEE\u6539\u7684\u5BC6\u7801",-1)),zu={class:"action-icon"},$u={class:"username-block"},Lu=["src"],Ru={key:1},Mu={key:0,style:{color:"rgb(var(--red-4))"}},qu={key:1},Ou={name:"UserManager"},ju=Oe({...Ou,setup(o){const T=je("baseURL"),x=()=>({id:void 0,nickname:"",username:"",email:"",phoneNumber:""}),ee=_(!0),{loading:ue,setLoading:m}=Cu(!0),{t:I}=ze.exports.useI18n(),O=_([]),r=_(x()),N=_("small"),S={current:1,pageSize:10,showJumper:!0,showTotal:!0,showMore:!0},k=W({...S}),ae=Pe(()=>[{name:I("searchTable.size.mini"),value:"mini"},{name:I("searchTable.size.small"),value:"small"},{name:I("searchTable.size.medium"),value:"medium"},{name:I("searchTable.size.large"),value:"large"}]),te=async l=>{if(l.id!==void 0){const u=await Vu(l.id);u.status?(n.success(u.message),h()):n.error(u.message)}else n.error("\u7528\u6237ID\u65E0\u6548")},z=async(l={current:1,pageSize:10})=>{m(!0);try{const{data:u}=await ku(l);O.value=u.records,k.current=l.current,k.total=u.total}catch{}finally{m(!1)}},le=async l=>{m(!0);try{if(l.id!==void 0){const u=await Au(Number(l.id));u.status?n.success(u.message):n.error(u.message)}else n.error("\u7528\u6237ID\u83B7\u53D6\u9519\u8BEF\uFF0C\u65E0\u6CD5\u5220\u9664~");h()}catch{}finally{m(!1)}},se=()=>{r.value=x()},h=()=>{z({...S,...r.value})},oe=l=>{z({...S,current:l})},D=_(!1),$=_(!1),j=_(),s=W({id:-1,nickname:"",username:"",password:"",email:"",phoneNumber:"",remark:""}),ne=async l=>{try{if(await j.value.validate()===void 0){const p={...s};m(!0);try{p.id!==void 0&&p.id>0?ce(p):de(p),l(!0)}catch{n.error("\u5F02\u5E38")}finally{m(!1)}}else l(!1)}catch{n.error("\u8868\u5355\u586B\u5199\u9519\u8BEF"),l(!1)}},re=()=>{s.id=-1,s.username="",s.password="",s.phoneNumber="",s.remark="",D.value=!1},ie=()=>{D.value=!0},de=async l=>{const u=await Eu(l);u.status?(n.success(u.message),h(),s.username="",s.password="",s.phoneNumber=""):n.error(u.message)},ce=async l=>{const u=await Uu(l);u.status?(n.success(u.message),h(),s.username="",s.password="",s.phoneNumber=""):n.error(u.message)},me=async l=>{m(!0);try{s.nickname=l.nickname||"",s.username=l.username||"",s.password="",s.email=l.email||"",s.phoneNumber=l.phoneNumber||"",s.remark=l.remark||"",s.id=l.id,D.value=!0}catch{}finally{m(!1)}},L=_(null),E=_(),P=_(),pe=async()=>{const l=await wu();l.status?P.value=l.data:n.error(l.message)},_e=async l=>{const u=await xu(l.id);u.status?(E.value=u.data.map(p=>p.id),console.log(E.value)):n.error(u.message)},fe=async l=>{try{if(L.value){const u=L.value.id,p=E.value;(await Iu(u,p)).status?(n.success("\u89D2\u8272\u66F4\u65B0\u6210\u529F"),l(!0)):(n.error("\u89D2\u8272\u66F4\u65B0\u5931\u8D25"),l(!1))}else n.error("\u7528\u6237\u4FE1\u606F\u4E0D\u5B58\u5728"),l(!1)}catch{n.error("\u53D1\u751F\u9519\u8BEF\uFF0C\u65E0\u6CD5\u66F4\u65B0\u89D2\u8272"),l(!1)}},Fe=()=>{D.value=!1},ve=async l=>{m(!0);try{pe(),_e(l),$.value=!0,L.value=l}catch{}finally{m(!1)}},be=(l,u)=>{N.value=l};return Je(()=>{z()}),(l,u)=>{const p=He("Breadcrumb"),R=Qe,c=We,f=Xe,F=Ge,M=Ye,J=eu,H=uu,Be=au,y=tu,Z=$e,K=lu,ge=su,he=ou,Q=nu,De=ru,ye=iu,A=du,Ce=Le,we=cu,ke=mu,i=pu,Ee=_u,Ae=fu,Ue=Fu,Ve=vu,xe=bu,Ie=Bu,Te=Re,Ne=gu,Se=hu,U=Ze("permission");return d(),C("div",Nu,[e(p,{items:["\u7CFB\u7EDF\u7BA1\u7406","\u7528\u6237\u7BA1\u7406"]}),e(Se,{class:"general-card",title:"\u7528\u6237\u7BA1\u7406"},{default:a(()=>[e(M,null,{default:a(()=>[e(f,{flex:1},{default:a(()=>[e(J,{model:r.value,"label-col-props":{span:6},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(M,{gutter:16},{default:a(()=>[e(f,{span:6},{default:a(()=>[e(c,{field:"id",label:"\u7528\u6237ID"},{default:a(()=>[e(R,{modelValue:r.value.id,"onUpdate:modelValue":u[0]||(u[0]=t=>r.value.id=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237ID",min:1},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:6},{default:a(()=>[e(c,{field:"nickname",label:"\u7528\u6237\u6635\u79F0"},{default:a(()=>[e(F,{modelValue:r.value.nickname,"onUpdate:modelValue":u[1]||(u[1]=t=>r.value.nickname=t),placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:6},{default:a(()=>[e(c,{field:"username",label:"\u7528\u6237\u540D"},{default:a(()=>[e(F,{modelValue:r.value.username,"onUpdate:modelValue":u[2]||(u[2]=t=>r.value.username=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D","allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:6},{default:a(()=>[e(c,{field:"phoneNumber",label:"\u624B\u673A\u53F7"},{default:a(()=>[e(F,{modelValue:r.value.phoneNumber,"onUpdate:modelValue":u[3]||(u[3]=t=>r.value.phoneNumber=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u624B\u673A\u53F7","allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:6},{default:a(()=>[e(c,{field:"email",label:"\u90AE\u7BB1"},{default:a(()=>[e(F,{modelValue:r.value.email,"onUpdate:modelValue":u[4]||(u[4]=t=>r.value.email=t),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1","allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(H,{style:{height:"84px"},direction:"vertical"}),e(f,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(K,{direction:"vertical",size:18},{default:a(()=>[e(y,{type:"primary",onClick:h},{icon:a(()=>[e(Be)]),default:a(()=>[w(" "+v(l.$t("searchTable.form.search")),1)]),_:1}),e(y,{onClick:se},{icon:a(()=>[e(Z)]),default:a(()=>[w(" "+v(l.$t("searchTable.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(H,{style:{"margin-top":"0"}}),e(M,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(f,{span:12},{default:a(()=>[e(K,null,{default:a(()=>[V((d(),b(y,{type:"primary",onClick:ie},{icon:a(()=>[e(ge)]),default:a(()=>[w(" "+v(l.$t("searchTable.operation.create")),1)]),_:1})),[[U,["sys:user:add"]]]),e(Q,{visible:D.value,"onUpdate:visible":u[11]||(u[11]=t=>D.value=t),title:"\u7528\u6237\u4FE1\u606F",onCancel:re,onBeforeOk:ne,draggable:""},{default:a(()=>[e(J,{ref_key:"userModalFormRef",ref:j,model:s},{default:a(()=>[e(c,{field:"nickname",label:"\u6635\u79F0",rules:[{required:!0,message:"\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],"validate-trigger":["blur"]},{default:a(()=>[e(F,{modelValue:s.nickname,"onUpdate:modelValue":u[5]||(u[5]=t=>s.nickname=t),placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0"},null,8,["modelValue"])]),_:1}),e(c,{field:"username",label:"\u7528\u6237\u540D",rules:[{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A"},{minLength:3,maxLength:20,message:"\u7528\u6237\u540D\u5FC5\u987B\u57283-20\u4E2A\uFF08\u5B57\u6BCD\u6216\u6570\u5B57\uFF09\u5B57\u7B26\u5185"},{match:/^[A-Za-z0-9]+$/,message:"\u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u548C\u6570\u5B57"}],"validate-trigger":["blur"]},{default:a(()=>[e(F,{modelValue:s.username,"onUpdate:modelValue":u[6]||(u[6]=t=>s.username=t),placeholder:"\u8BF7\u8F93\u5165\u82F1\u6587+\u6570\u5B57\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),e(c,{field:"password",label:"\u5BC6\u7801",rules:[{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"},{minLength:5,maxLength:20,message:"\u5BC6\u7801\u5FC5\u987B\u57285-20\u4E2A\uFF08\u5B57\u6BCD\u6216\u6570\u5B57\uFF09\u5B57\u7B26\u5185"},{match:/^[A-Za-z0-9]+$/,message:"\u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u548C\u6570\u5B57"}],"validate-trigger":["blur"]},{extra:a(()=>[Su]),default:a(()=>[e(F,{modelValue:s.password,"onUpdate:modelValue":u[7]||(u[7]=t=>s.password=t),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),e(c,{field:"email",label:"\u90AE\u7BB1",rules:[{type:"email",required:!0}],"validate-trigger":["blur"]},{default:a(()=>[e(F,{modelValue:s.email,"onUpdate:modelValue":u[8]||(u[8]=t=>s.email=t),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},null,8,["modelValue"])]),_:1}),e(c,{field:"phoneNumber",label:"\u624B\u673A\u53F7",rules:[{required:!0,message:"\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A"},{length:11,message:"\u624B\u673A\u53F7\u5FC5\u987B11\u4F4D\u6570\u5B57"},{match:/^[1][3-9][0-9]{9}$/,message:"\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E"}],"validate-trigger":["blur"]},{default:a(()=>[e(F,{modelValue:s.phoneNumber,"onUpdate:modelValue":u[9]||(u[9]=t=>s.phoneNumber=t),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),_:1}),e(c,{field:"remark",label:"\u5907\u6CE8"},{default:a(()=>[e(he,{modelValue:s.remark,"onUpdate:modelValue":u[10]||(u[10]=t=>s.remark=t),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8","allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),e(Q,{visible:$.value,"onUpdate:visible":u[13]||(u[13]=t=>$.value=t),title:"\u7ED9\u7528\u6237\u5206\u914D\u89D2\u8272",onCancel:Fe,onBeforeOk:fe,draggable:""},{default:a(()=>[e(ye,{style:{width:"100%",height:"60px"},"model-value":E.value,"onUpdate:modelValue":u[12]||(u[12]=t=>E.value=t),placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272...",multiple:"","allow-clear":"",scrollbar:ee.value},{default:a(()=>[(d(!0),C(X,null,G(P.value,t=>(d(),b(De,{key:t.id,value:t.id},{default:a(()=>[w(v(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["model-value","scrollbar"])]),_:1},8,["visible"])]),_:1})]),_:1}),e(f,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:a(()=>[e(A,{content:l.$t("searchTable.actions.refresh")},{default:a(()=>[B("div",{class:"action-icon",onClick:h},[e(Z,{size:"18"})])]),_:1},8,["content"]),e(ke,{onSelect:be},{content:a(()=>[(d(!0),C(X,null,G(ae.value,t=>(d(),b(we,{key:t.value,value:t.value,class:Ke({active:t.value===N.value})},{default:a(()=>[B("span",null,v(t.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(A,{content:l.$t("searchTable.actions.density")},{default:a(()=>[B("div",zu,[e(Ce,{size:"18"})])]),_:1},8,["content"])]),_:1})]),_:1})]),_:1}),e(Ne,{"row-key":"id","column-resizable":"",loading:Y(ue),pagination:k,data:O.value,bordered:!1,size:N.value,onPageChange:oe},{columns:a(()=>[e(i,{title:"#","data-index":"",width:50},{cell:a(({rowIndex:t})=>[w(v(t+1+(k.current-1)*k.pageSize),1)]),_:1}),e(i,{title:"\u7528\u6237ID","data-index":"id",width:80}),e(i,{title:"\u6635\u79F0","data-index":"nickname",width:100}),e(i,{title:"\u767B\u5F55\u540D","data-index":"username",width:200},{cell:a(({record:t})=>[B("div",$u,[e(Ee,{size:32,style:{cursor:"pointer"}},{default:a(()=>[B("img",{src:`${Y(T)}/api/${t.avatar}`},null,8,Lu)]),_:2},1024),B("span",null,v(t.username),1),t.isAdmin==0?(d(),b(Ae,{key:0,size:"small",color:"#f53f3f"},{default:a(()=>[w("\u7BA1\u7406\u5458")]),_:1})):(d(),C("span",Ru))])]),_:1}),e(i,{title:"\u90AE\u7BB1","data-index":"email"}),e(i,{title:"\u7535\u8BDD\u53F7\u7801","data-index":"phoneNumber"}),e(i,{title:"\u8D26\u53F7\u72B6\u6001","data-index":"status"},{cell:a(({record:t})=>[V(e(Ue,{"model-value":t.status==0,"checked-color":"#00aa31",onChange:q=>te(t)},null,8,["model-value","onChange"]),[[U,["sys:user:add"]]])]),_:1}),e(i,{title:"\u5220\u9664\u72B6\u6001","data-index":"isDelete"},{cell:a(({record:t})=>[t.isDelete==0?(d(),C("span",Mu,"\u5DF2\u5220\u9664")):(d(),C("span",qu,"\u672A\u5220\u9664"))]),_:1}),e(i,{title:"\u4ECB\u7ECD","data-index":"introduction",ellipsis:!0,tooltip:!0}),e(i,{title:"\u5907\u6CE8","data-index":"remark",ellipsis:!0,tooltip:!0}),e(i,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"createTime"}),e(i,{title:"\u66F4\u65B0\u65F6\u95F4","data-index":"updateTime"}),e(i,{title:"\u64CD\u4F5C"},{cell:a(({record:t})=>[e(A,{content:"\u66F4\u65B0\u7528\u6237\u4FE1\u606F"},{default:a(()=>[V((d(),b(y,{class:"nav-btn",shape:"circle",onClick:q=>me(t)},{icon:a(()=>[e(Ve)]),_:2},1032,["onClick"])),[[U,["sys:user:edit"]]])]),_:2},1024),e(Ie,{content:`\u662F\u5426\u5220\u9664 ${t.username}\u7528\u6237\uFF1F`,onOk:q=>le(t)},{default:a(()=>[e(A,{content:"\u5220\u9664\u8BE5\u7528\u6237"},{default:a(()=>[V((d(),b(y,{class:"nav-btn",shape:"circle"},{icon:a(()=>[e(xe)]),_:1})),[[U,["sys:user:delete"]]])]),_:1})]),_:2},1032,["content","onOk"]),e(A,{content:"\u5206\u914D\u89D2\u8272"},{default:a(()=>[V((d(),b(y,{class:"nav-btn",shape:"circle",onClick:q=>ve(t)},{icon:a(()=>[e(Te)]),_:2},1032,["onClick"])),[[U,["sys:user:roles"]]])]),_:2},1024)]),_:1})]),_:1},8,["loading","pagination","data","size"])]),_:1})])}}});const oa=Me(ju,[["__scopeId","data-v-40b3e171"]]);export{oa as default};
